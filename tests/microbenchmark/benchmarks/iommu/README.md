# IOMMU benchmark

This benchmark contains tests that are measuring performance of different IOMMU operations through UMD and KMD.

IOMMU operations that UMD does are mapping the buffer through IOMMU and unampping it when it is not needed anymore. Both operations are done by making ioctl call to KMD.

## Results

### Mapping different sizes with IOMMU

| Number of pages | Mapping size (MB) | Average map time (ns) | Bandwidth map (MB/s) | Average unmap time (ns) | Bandwidth unmap (MB/s) |
|---|---|---|---|---|---|
| 1.00 | 0.00 | 20418.00 | 191.31 | 21301.00 | 183.38 |
| 2.00 | 0.00 | 21548.00 | 362.56 | 30844.00 | 253.29 |
| 4.00 | 0.00 | 28985.00 | 539.07 | 48018.00 | 325.40 |
| 8.00 | 0.00 | 54813.00 | 570.12 | 101095.00 | 309.12 |
| 16.00 | 0.00 | 85164.00 | 733.88 | 153440.00 | 407.33 |
| 32.00 | 0.00 | 116143.00 | 1076.26 | 407850.00 | 306.49 |
| 64.00 | 0.00 | 261064.00 | 957.62 | 557351.00 | 448.55 |
| 128.00 | 0.00 | 462981.00 | 1079.96 | 1081240.00 | 462.43 |
| 256.00 | 1.00 | 769940.00 | 1298.80 | 2141362.00 | 466.99 |
| 512.00 | 2.00 | 1597899.00 | 1251.64 | 3774593.00 | 529.86 |
| 1024.00 | 4.00 | 3064844.00 | 1305.12 | 8126527.00 | 492.22 |
| 2048.00 | 8.00 | 6625268.00 | 1207.50 | 15175334.00 | 527.17 |
| 4096.00 | 16.00 | 12288348.00 | 1302.05 | 29370120.00 | 544.77 |
| 8192.00 | 32.00 | 24616148.00 | 1299.96 | 60247223.00 | 531.14 |
| 16384.00 | 64.00 | 48471598.00 | 1320.36 | 119874332.00 | 533.89 |
| 32768.00 | 128.00 | 98764664.00 | 1296.01 | 241551922.00 | 529.91 |
| 65536.00 | 256.00 | 199796772.00 | 1281.30 | 481864442.00 | 531.27 |
| 131072.00 | 512.00 | 407482019.00 | 1256.50 | 970738770.00 | 527.43 |
| 262144.00 | 1024.00 | 806153725.00 | 1270.23 | 1895624261.00 | 540.19 |