# PCIe DMA benchmark

This benchmark contains tests that are measuring performance of multiple usages of PCIe DMA engine.

To get a better understanding of the usages, please look at the [tests](test_pcie_dma.cpp).

## Example results

### DMA DRAM
```
|             ns/byte |              byte/s |    err% |     total | DMA_DRAM
|--------------------:|--------------------:|--------:|----------:|:---------
|              905.16 |        1,104,773.48 |    0.1% |      0.01 | `DMA, write, 4 bytes`
|              453.21 |        2,206,481.44 |    0.2% |      0.01 | `DMA, write, 8 bytes`
|              226.37 |        4,417,483.66 |    0.1% |      0.01 | `DMA, write, 16 bytes`
|              113.26 |        8,829,414.88 |    0.2% |      0.01 | `DMA, write, 32 bytes`
|                3.77 |      265,067,556.00 |    0.1% |      0.01 | `DMA, write, 1024 bytes`
|                1.95 |      513,219,117.38 |    0.1% |      0.01 | `DMA, write, 2048 bytes`
|                1.06 |      945,301,725.50 |    0.1% |      0.01 | `DMA, write, 4096 bytes`
|                0.62 |    1,620,747,425.82 |    0.1% |      0.01 | `DMA, write, 8192 bytes`
|                0.40 |    2,513,354,311.35 |    0.1% |      0.01 | `DMA, write, 16384 bytes`
|                0.25 |    3,923,295,266.50 |    0.1% |      0.01 | `DMA, write, 32768 bytes`
|                0.13 |    7,669,619,518.26 |    0.1% |      0.01 | `DMA, write, 1048576 bytes`
|                0.13 |    7,878,395,245.51 |    0.2% |      0.01 | `DMA, write, 2097152 bytes`
|                0.13 |    7,877,152,373.54 |    0.1% |      0.01 | `DMA, write, 4194304 bytes`
|                0.13 |    7,658,702,971.96 |    1.2% |      0.01 | `DMA, write, 8388608 bytes`
|                0.15 |    6,866,587,648.24 |    0.7% |      0.03 | `DMA, write, 16777216 bytes`
|                0.15 |    6,659,249,249.47 |    0.4% |      0.06 | `DMA, write, 33554432 bytes`
|                0.15 |    6,623,249,262.96 |    0.1% |      1.79 | `DMA, write, 1073741824 bytes`
|              829.81 |        1,205,101.01 |    0.1% |      0.01 | `DMA, read, 4 bytes`
|              415.18 |        2,408,566.83 |    0.2% |      0.01 | `DMA, read, 8 bytes`
|              207.36 |        4,822,447.52 |    0.0% |      0.01 | `DMA, read, 16 bytes`
|              103.72 |        9,641,458.27 |    0.1% |      0.01 | `DMA, read, 32 bytes`
|                3.41 |      293,584,876.12 |    0.1% |      0.01 | `DMA, read, 1024 bytes`
|                1.76 |      569,473,903.99 |    0.3% |      0.01 | `DMA, read, 2048 bytes`
|                0.94 |    1,066,702,985.14 |    0.0% |      0.01 | `DMA, read, 4096 bytes`
|                0.51 |    1,956,174,851.11 |    0.0% |      0.01 | `DMA, read, 8192 bytes`
|                0.30 |    3,281,647,233.08 |    0.2% |      0.01 | `DMA, read, 16384 bytes`
|                0.21 |    4,872,180,171.64 |    0.1% |      0.01 | `DMA, read, 32768 bytes`
|                0.13 |    7,772,731,315.99 |    0.5% |      0.01 | `DMA, read, 1048576 bytes`
|                0.12 |    8,078,615,370.98 |    0.4% |      0.01 | `DMA, read, 2097152 bytes`
|                0.12 |    8,091,238,791.92 |    0.3% |      0.01 | `DMA, read, 4194304 bytes`
|                0.12 |    8,109,801,146.39 |    0.2% |      0.01 | `DMA, read, 8388608 bytes`
|                0.12 |    8,112,746,233.45 |    0.2% |      0.02 | `DMA, read, 16777216 bytes`
|                0.12 |    8,001,152,204.50 |    0.1% |      0.05 | `DMA, read, 33554432 bytes`
|                0.13 |    7,983,148,918.28 |    0.3% |      1.48 | `DMA, read, 1073741824 bytes`
```

### DMA Tensix
```
|             ns/byte |              byte/s |    err% |     total | DMA_Tensix
|--------------------:|--------------------:|--------:|----------:|:-----------
|              927.87 |        1,077,738.59 |    0.0% |      0.01 | `DMA, write, 4 bytes`
|              463.55 |        2,157,252.67 |    0.1% |      0.01 | `DMA, write, 8 bytes`
|                3.85 |      259,495,959.51 |    0.1% |      0.01 | `DMA, write, 1024 bytes`
|                1.98 |      504,403,917.20 |    0.1% |      0.01 | `DMA, write, 2048 bytes`
|                1.07 |      934,655,362.80 |    0.1% |      0.01 | `DMA, write, 4096 bytes`
|                0.62 |    1,612,788,597.70 |    0.1% |      0.01 | `DMA, write, 8192 bytes`
|                0.13 |    7,809,567,609.59 |    0.1% |      0.01 | `DMA, write, 1048576 bytes`
|              851.86 |        1,173,902.68 |    0.0% |      0.01 | `DMA, read, 4 bytes`
|              426.07 |        2,347,039.96 |    0.1% |      0.01 | `DMA, read, 8 bytes`
|                3.48 |      287,102,803.74 |    0.1% |      0.01 | `DMA, read, 1024 bytes`
|                1.79 |      558,603,871.80 |    0.1% |      0.01 | `DMA, read, 2048 bytes`
|                0.94 |    1,060,265,363.26 |    0.0% |      0.01 | `DMA, read, 4096 bytes`
|                0.52 |    1,922,624,537.06 |    0.1% |      0.01 | `DMA, read, 8192 bytes`
|                0.13 |    7,756,517,336.55 |    0.1% |      0.01 | `DMA, read, 1048576 bytes`
```

### DMA Ethernet
```
|             ns/byte |              byte/s |    err% |     total | DMA_Ethernet
|--------------------:|--------------------:|--------:|----------:|:-------------
|              931.42 |        1,073,632.66 |    0.4% |      0.01 | `DMA, write, 4 bytes`
|              464.90 |        2,151,010.73 |    0.2% |      0.01 | `DMA, write, 8 bytes`
|                3.87 |      258,373,472.17 |    0.3% |      0.01 | `DMA, write, 1024 bytes`
|                1.98 |      504,425,096.79 |    0.1% |      0.01 | `DMA, write, 2048 bytes`
|                1.08 |      928,741,034.57 |    0.3% |      0.01 | `DMA, write, 4096 bytes`
|                0.62 |    1,608,218,303.07 |    0.1% |      0.01 | `DMA, write, 8192 bytes`
|                0.13 |    7,456,998,112.92 |    0.1% |      0.01 | `DMA, write, 131072 bytes`
|              852.23 |        1,173,389.21 |    0.1% |      0.01 | `DMA, read, 4 bytes`
|              426.25 |        2,346,022.74 |    0.1% |      0.01 | `DMA, read, 8 bytes`
|                3.48 |      286,997,676.68 |    0.0% |      0.01 | `DMA, read, 1024 bytes`
|                1.79 |      558,339,484.24 |    0.1% |      0.01 | `DMA, read, 2048 bytes`
|                0.94 |    1,059,698,364.13 |    0.0% |      0.01 | `DMA, read, 4096 bytes`
|                0.52 |    1,915,377,292.23 |    0.0% |      0.01 | `DMA, read, 8192 bytes`
|                0.13 |    7,666,084,084.50 |    0.0% |      0.01 | `DMA, read, 131072 bytes`
```
### DMA DRAM Sweep Sizes
```
|             ns/byte |              byte/s |    err% |     total | DMA_DRAM_Sweep
|--------------------:|--------------------:|--------:|----------:|:---------------
|              904.65 |        1,105,393.79 |    0.1% |      0.01 | `DMA, write, 4 bytes`
|              829.48 |        1,205,573.11 |    0.0% |      0.01 | `DMA, read, 4 bytes`
|              452.80 |        2,208,494.62 |    0.1% |      0.01 | `DMA, write, 8 bytes`
|              414.74 |        2,411,147.09 |    0.0% |      0.01 | `DMA, read, 8 bytes`
|              226.43 |        4,416,371.48 |    0.1% |      0.01 | `DMA, write, 16 bytes`
|              207.28 |        4,824,298.06 |    0.0% |      0.01 | `DMA, read, 16 bytes`
|              113.22 |        8,832,535.95 |    0.1% |      0.01 | `DMA, write, 32 bytes`
|              103.67 |        9,646,386.54 |    0.0% |      0.01 | `DMA, read, 32 bytes`
|               56.65 |       17,652,150.52 |    0.1% |      0.01 | `DMA, write, 64 bytes`
|               52.00 |       19,231,960.41 |    0.1% |      0.01 | `DMA, read, 64 bytes`
|               28.50 |       35,088,950.96 |    0.1% |      0.01 | `DMA, write, 128 bytes`
|               26.25 |       38,098,360.91 |    0.0% |      0.01 | `DMA, read, 128 bytes`
|               14.47 |       69,130,102.48 |    0.3% |      0.01 | `DMA, write, 256 bytes`
|               13.13 |       76,188,840.60 |    0.0% |      0.01 | `DMA, read, 256 bytes`
|                7.50 |      133,338,913.92 |    0.0% |      0.01 | `DMA, write, 512 bytes`
|                6.75 |      148,152,653.82 |    0.0% |      0.01 | `DMA, read, 512 bytes`
|                3.76 |      265,613,770.60 |    0.1% |      0.01 | `DMA, write, 1024 bytes`
|                3.40 |      294,373,716.63 |    0.1% |      0.01 | `DMA, read, 1024 bytes`
|                1.94 |      514,645,853.51 |    0.1% |      0.01 | `DMA, write, 2048 bytes`
|                1.75 |      572,876,559.05 |    0.2% |      0.01 | `DMA, read, 2048 bytes`
|                1.06 |      945,069,730.08 |    0.3% |      0.01 | `DMA, write, 4096 bytes`
|                0.94 |    1,066,719,366.66 |    0.0% |      0.01 | `DMA, read, 4096 bytes`
|                0.62 |    1,621,433,258.48 |    0.1% |      0.01 | `DMA, write, 8192 bytes`
|                0.51 |    1,963,679,665.54 |    0.1% |      0.01 | `DMA, read, 8192 bytes`
|                0.40 |    2,511,558,057.90 |    0.1% |      0.01 | `DMA, write, 16384 bytes`
|                0.31 |    3,266,895,505.59 |    0.1% |      0.01 | `DMA, read, 16384 bytes`
|                0.25 |    3,931,848,751.55 |    0.1% |      0.01 | `DMA, write, 32768 bytes`
|                0.21 |    4,815,383,371.26 |    0.1% |      0.01 | `DMA, read, 32768 bytes`
|                0.17 |    5,890,184,871.67 |    0.1% |      0.01 | `DMA, write, 65536 bytes`
|                0.16 |    6,408,217,312.83 |    0.0% |      0.01 | `DMA, read, 65536 bytes`
|                0.14 |    7,398,323,504.71 |    0.1% |      0.01 | `DMA, write, 131072 bytes`
|                0.13 |    7,739,179,956.61 |    0.1% |      0.01 | `DMA, read, 131072 bytes`
|                0.12 |    8,469,421,681.79 |    0.1% |      0.01 | `DMA, write, 262144 bytes`
|                0.12 |    8,661,765,434.75 |    0.0% |      0.01 | `DMA, read, 262144 bytes`
|                0.11 |    8,821,852,715.60 |    0.2% |      0.01 | `DMA, write, 524288 bytes`
|                0.11 |    9,158,544,443.84 |    0.2% |      0.01 | `DMA, read, 524288 bytes`
|                0.13 |    7,625,272,473.74 |    0.1% |      0.01 | `DMA, write, 1048576 bytes`
|                0.13 |    7,764,619,854.62 |    0.1% |      0.01 | `DMA, read, 1048576 bytes`
|                0.13 |    7,854,031,219.10 |    0.2% |      0.01 | `DMA, write, 2097152 bytes`
|                0.13 |    7,957,290,998.71 |    0.9% |      0.01 | `DMA, read, 2097152 bytes`
|                0.13 |    7,843,874,451.00 |    0.2% |      0.01 | `DMA, write, 4194304 bytes`
|                0.12 |    8,027,998,342.46 |    0.4% |      0.01 | `DMA, read, 4194304 bytes`
|                0.13 |    7,752,972,774.14 |    0.4% |      0.01 | `DMA, write, 8388608 bytes`
|                0.12 |    8,079,237,825.20 |    0.1% |      0.01 | `DMA, read, 8388608 bytes`
|                0.14 |    7,038,845,941.17 |    1.2% |      0.03 | `DMA, write, 16777216 bytes`
|                0.12 |    8,086,137,924.79 |    0.0% |      0.02 | `DMA, read, 16777216 bytes`
|                0.15 |    6,739,578,132.02 |    0.3% |      0.05 | `DMA, write, 33554432 bytes`
|                0.12 |    8,004,139,179.68 |    0.1% |      0.05 | `DMA, read, 33554432 bytes`
|                0.15 |    6,661,008,766.36 |    0.3% |      0.11 | `DMA, write, 67108864 bytes`
|                0.12 |    8,002,612,012.83 |    0.1% |      0.09 | `DMA, read, 67108864 bytes`
|                0.15 |    6,621,359,004.89 |    0.2% |      0.22 | `DMA, write, 134217728 bytes`
|                0.13 |    7,989,614,634.75 |    0.5% |      0.18 | `DMA, read, 134217728 bytes`
|                0.15 |    6,626,756,741.13 |    0.3% |      0.45 | `DMA, write, 268435456 bytes`
|                0.13 |    7,991,878,180.33 |    0.8% |      0.37 | `DMA, read, 268435456 bytes`
|                0.15 |    6,644,046,297.64 |    0.2% |      0.89 | `DMA, write, 536870912 bytes`
|                0.12 |    8,007,412,619.91 |    0.3% |      0.75 | `DMA, read, 536870912 bytes`
|                0.15 |    6,638,587,575.78 |    0.1% |      1.79 | `DMA, write, 1073741824 bytes`
|                0.12 |    8,028,767,485.49 |    0.1% |      1.47 | `DMA, read, 1073741824 bytes`
```

### DMA Tensix Sweep Sizes
```
|             ns/byte |              byte/s |    err% |     total | DMA_Tensix_Sweep
|--------------------:|--------------------:|--------:|----------:|:-----------------
|              928.88 |        1,076,569.73 |    0.1% |      0.01 | `DMA, write, 4 bytes`
|              853.26 |        1,171,971.06 |    0.0% |      0.01 | `DMA, read, 4 bytes`
|              464.66 |        2,152,128.12 |    0.1% |      0.01 | `DMA, write, 8 bytes`
|              426.50 |        2,344,684.15 |    0.0% |      0.01 | `DMA, read, 8 bytes`
|              231.77 |        4,314,549.38 |    0.0% |      0.01 | `DMA, write, 16 bytes`
|              213.24 |        4,689,514.75 |    0.0% |      0.01 | `DMA, read, 16 bytes`
|              115.90 |        8,628,230.93 |    0.0% |      0.01 | `DMA, write, 32 bytes`
|              106.57 |        9,383,725.39 |    0.1% |      0.01 | `DMA, read, 32 bytes`
|               58.17 |       17,191,932.30 |    0.2% |      0.01 | `DMA, write, 64 bytes`
|               53.45 |       18,709,499.29 |    0.1% |      0.01 | `DMA, read, 64 bytes`
|               29.20 |       34,240,822.66 |    0.2% |      0.01 | `DMA, write, 128 bytes`
|               26.86 |       37,230,548.49 |    0.1% |      0.01 | `DMA, read, 128 bytes`
|               14.74 |       67,825,197.04 |    0.1% |      0.01 | `DMA, write, 256 bytes`
|               13.56 |       73,771,649.05 |    0.3% |      0.01 | `DMA, read, 256 bytes`
|                7.56 |      132,351,295.77 |    0.1% |      0.01 | `DMA, write, 512 bytes`
|                6.90 |      144,870,691.59 |    0.1% |      0.01 | `DMA, read, 512 bytes`
|                3.85 |      259,714,363.18 |    0.0% |      0.01 | `DMA, write, 1024 bytes`
|                3.49 |      286,791,323.76 |    0.1% |      0.01 | `DMA, read, 1024 bytes`
|                2.00 |      500,552,770.77 |    0.1% |      0.01 | `DMA, write, 2048 bytes`
|                1.79 |      557,354,470.31 |    0.0% |      0.01 | `DMA, read, 2048 bytes`
|                1.07 |      932,123,132.40 |    0.1% |      0.01 | `DMA, write, 4096 bytes`
|                0.95 |    1,058,184,141.56 |    0.2% |      0.01 | `DMA, read, 4096 bytes`
|                0.62 |    1,609,797,484.51 |    0.1% |      0.01 | `DMA, write, 8192 bytes`
|                0.52 |    1,915,680,409.36 |    0.1% |      0.01 | `DMA, read, 8192 bytes`
|                0.40 |    2,501,721,067.52 |    0.1% |      0.01 | `DMA, write, 16384 bytes`
|                0.31 |    3,219,913,813.91 |    0.1% |      0.01 | `DMA, read, 16384 bytes`
|                0.25 |    3,946,749,818.50 |    0.2% |      0.01 | `DMA, write, 32768 bytes`
|                0.21 |    4,756,109,725.69 |    0.0% |      0.01 | `DMA, read, 32768 bytes`
|                0.17 |    5,913,632,340.18 |    0.1% |      0.01 | `DMA, write, 65536 bytes`
|                0.16 |    6,368,069,586.43 |    0.0% |      0.01 | `DMA, read, 65536 bytes`
|                0.13 |    7,463,116,430.02 |    0.0% |      0.01 | `DMA, write, 131072 bytes`
|                0.13 |    7,700,798,082.60 |    0.0% |      0.01 | `DMA, read, 131072 bytes`
|                0.12 |    8,619,688,231.45 |    0.0% |      0.01 | `DMA, write, 262144 bytes`
|                0.11 |    8,805,915,079.68 |    0.0% |      0.01 | `DMA, read, 262144 bytes`
|                0.11 |    9,287,455,359.67 |    0.0% |      0.01 | `DMA, write, 524288 bytes`
|                0.11 |    9,206,856,081.41 |    0.0% |      0.01 | `DMA, read, 524288 bytes`
|                0.13 |    7,849,724,418.66 |    0.0% |      0.01 | `DMA, write, 1048576 bytes`
|                0.13 |    7,819,672,115.87 |    0.1% |      0.01 | `DMA, read, 1048576 bytes`
```

### DMA Ethernet Sweep Sizes
```
|             ns/byte |              byte/s |    err% |     total | DMA_Ethernet_Sweep
|--------------------:|--------------------:|--------:|----------:|:-------------------
|              931.39 |        1,073,668.85 |    0.2% |      0.01 | `DMA, write, 4 bytes`
|              853.75 |        1,171,309.24 |    0.1% |      0.01 | `DMA, read, 4 bytes`
|              465.59 |        2,147,793.58 |    0.2% |      0.01 | `DMA, write, 8 bytes`
|              426.61 |        2,344,049.87 |    0.1% |      0.01 | `DMA, read, 8 bytes`
|              232.34 |        4,304,013.86 |    0.2% |      0.01 | `DMA, write, 16 bytes`
|              213.75 |        4,678,414.88 |    0.3% |      0.01 | `DMA, read, 16 bytes`
|              116.10 |        8,613,593.07 |    0.0% |      0.01 | `DMA, write, 32 bytes`
|              106.58 |        9,382,481.90 |    0.1% |      0.01 | `DMA, read, 32 bytes`
|               58.11 |       17,209,764.19 |    0.1% |      0.01 | `DMA, write, 64 bytes`
|               53.37 |       18,737,169.47 |    0.1% |      0.01 | `DMA, read, 64 bytes`
|               29.24 |       34,197,301.91 |    0.2% |      0.01 | `DMA, write, 128 bytes`
|               26.84 |       37,260,726.83 |    0.0% |      0.01 | `DMA, read, 128 bytes`
|               14.76 |       67,768,765.56 |    0.2% |      0.01 | `DMA, write, 256 bytes`
|               13.51 |       74,032,719.57 |    0.1% |      0.01 | `DMA, read, 256 bytes`
|                7.56 |      132,308,067.86 |    0.0% |      0.01 | `DMA, write, 512 bytes`
|                6.90 |      144,931,347.38 |    0.0% |      0.01 | `DMA, read, 512 bytes`
|                3.86 |      258,975,799.30 |    0.0% |      0.01 | `DMA, write, 1024 bytes`
|                3.48 |      286,972,615.62 |    0.0% |      0.01 | `DMA, read, 1024 bytes`
|                1.99 |      502,721,643.66 |    0.1% |      0.01 | `DMA, write, 2048 bytes`
|                1.79 |      558,912,506.35 |    0.0% |      0.01 | `DMA, read, 2048 bytes`
|                1.07 |      932,338,930.82 |    0.1% |      0.01 | `DMA, write, 4096 bytes`
|                0.94 |    1,059,082,611.06 |    0.0% |      0.01 | `DMA, read, 4096 bytes`
|                0.62 |    1,600,461,506.47 |    0.1% |      0.01 | `DMA, write, 8192 bytes`
|                0.52 |    1,920,375,633.18 |    0.1% |      0.01 | `DMA, read, 8192 bytes`
|                0.40 |    2,497,786,521.43 |    0.1% |      0.01 | `DMA, write, 16384 bytes`
|                0.31 |    3,202,865,368.31 |    0.0% |      0.01 | `DMA, read, 16384 bytes`
|                0.26 |    3,919,559,520.65 |    0.1% |      0.01 | `DMA, write, 32768 bytes`
|                0.21 |    4,730,118,304.08 |    0.0% |      0.01 | `DMA, read, 32768 bytes`
|                0.17 |    5,859,194,442.01 |    0.1% |      0.01 | `DMA, write, 65536 bytes`
|                0.16 |    6,333,977,333.41 |    0.1% |      0.01 | `DMA, read, 65536 bytes`
|                0.14 |    7,405,704,893.33 |    0.1% |      0.01 | `DMA, write, 131072 bytes`
|                0.13 |    7,650,098,127.19 |    0.1% |      0.01 | `DMA, read, 131072 bytes`
```
