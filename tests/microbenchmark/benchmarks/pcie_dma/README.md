# PCIe DMA benchmark

This benchmark contains tests that are measuring performance of multiple usages of PCIe DMA engine.

To get a better understanding of the usages, please look at the [tests](test_pcie_dma.cpp).

## Results

### PCIe DMA to Tensix core

| Size (bytes) | Host -> Device Tensix L1 (MB/s) | Device Tensix L1 -> Host (MB/s) |
|---|---|---|
| 4.00 | 1.01 | 1.16 |
| 8.00 | 1.93 | 2.29 |
| 16.00 | 4.09 | 4.65 |
| 32.00 | 8.18 | 8.67 |
| 64.00 | 16.35 | 18.08 |
| 128.00 | 32.59 | 36.95 |
| 256.00 | 64.66 | 71.28 |
| 512.00 | 125.86 | 143.99 |
| 1024.00 | 249.66 | 281.88 |
| 2048.00 | 477.93 | 532.62 |
| 4096.00 | 941.54 | 996.52 |
| 8192.00 | 1756.68 | 1719.11 |
| 16384.00 | 2934.82 | 2434.82 |
| 32768.00 | 4550.82 | 3478.10 |
| 65536.00 | 6646.25 | 4554.26 |
| 131072.00 | 8147.78 | 5217.13 |
| 262144.00 | 7780.62 | 5693.37 |
| 524288.00 | 9278.03 | 5827.76 |
| 1048576.00 | 9513.17 | 5941.63 |

### PCIe DMA to Tensix core - zero copy

| Size (bytes) | Host -> Device Tensix L1 (MB/s) | Device Tensix L1 -> Host (MB/s) |
|---|---|---|
| 1048576.00 | 12549.66 | 12594.90 |

### PCIe DMA to DRAM core

| Size (bytes) | Host -> Device DRAM (MB/s) | Device DRAM -> Host (MB/s) |
|---|---|---|
| 4.00 | 0.99 | 1.29 |
| 8.00 | 2.12 | 2.61 |
| 16.00 | 2.72 | 5.31 |
| 32.00 | 8.56 | 10.60 |
| 64.00 | 17.12 | 21.22 |
| 128.00 | 33.98 | 38.60 |
| 256.00 | 66.39 | 83.46 |
| 512.00 | 130.34 | 163.67 |
| 1024.00 | 248.79 | 321.31 |
| 2048.00 | 509.50 | 608.64 |
| 4096.00 | 970.93 | 1122.23 |
| 8192.00 | 1702.03 | 1670.95 |
| 16384.00 | 3045.39 | 2559.00 |
| 32768.00 | 4602.36 | 3534.23 |
| 65536.00 | 6561.27 | 4685.08 |
| 131072.00 | 8065.34 | 4469.14 |
| 262144.00 | 8155.67 | 5607.96 |
| 524288.00 | 8914.43 | 5783.73 |
| 1048576.00 | 9262.50 | 5908.97 |
| 2097152.00 | 9407.50 | 5907.71 |
| 4194304.00 | 9069.65 | 6019.08 |
| 8388608.00 | 6741.21 | 5532.91 |
| 16777216.00 | 7334.79 | 6025.78 |
| 33554432.00 | 6779.81 | 5875.59 |
| 67108864.00 | 6402.20 | 5802.43 |
| 134217728.00 | 6707.32 | 5942.59 |
| 268435456.00 | 6680.15 | 5981.69 |
| 536870912.00 | 6710.46 | 5692.59 |
| 1073741824.00 | 6527.52 | 5841.55 |


### PCIe DMA to DRAM core - zero copy

| Size (bytes) | DMA: Host -> Device DRAM (MB/s) | DMA: Device DRAM -> Host (MB/s) |
|---|---|---|
| 1048576.00 | 12014.43 | 12679.54 |


### PCIe DMA to ETH core

| Size (bytes) | Host -> Device Eth L1 (MB/s) | Device Eth L1 -> Host (MB/s) |
|---|---|---|
| 4.00 | 0.96 | 1.15 |
| 8.00 | 2.01 | 2.29 |
| 16.00 | 4.01 | 4.30 |
| 32.00 | 8.05 | 9.22 |
| 64.00 | 16.06 | 18.42 |
| 128.00 | 31.88 | 34.91 |
| 256.00 | 63.62 | 72.43 |
| 512.00 | 125.47 | 141.02 |
| 1024.00 | 241.37 | 278.63 |
| 2048.00 | 481.21 | 527.06 |
| 4096.00 | 912.57 | 968.14 |
| 8192.00 | 1626.42 | 1565.35 |
| 16384.00 | 2684.66 | 2202.69 |
| 32768.00 | 3470.48 | 3406.51 |
| 65536.00 | 6627.07 | 4549.39 |
| 131072.00 | 8130.02 | 4586.46 |